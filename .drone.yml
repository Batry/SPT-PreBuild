kind: pipeline
type: docker
name: build

platform:
  os: windows
  arch: amd64

trigger:
  event:
    - tag

steps:
  - name: clone-build-project
    image: alpine/git
    commands:
      - git clone https://dev.sp-tarkov.com/SPT-AKI/Build.git C:\Code
      
  - name: build-spt-release
    image: spt-build-environment:latest
    environment:
      MODULE_DOMAIN:
        from_secret: module_domain
    commands:
      - 'pwsh -File C:\Code\project\build.ps1 -Tag "${DRONE_TAG}"'
    volumes:
      - name: code
        path: C:\Code

volumes:
  - name: code
    temp: {}